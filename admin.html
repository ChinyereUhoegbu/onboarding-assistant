<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IT Onboarding Assistant - Administrator</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .navbar { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .card { border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
      <a class="navbar-brand" href="#"><i class="fas fa-shield-alt me-2"></i>Administrator Panel</a>
      <div class="navbar-nav ms-auto">
        <span class="navbar-text me-3">
          <i class="fas fa-user me-1"></i>
          Welcome, <span id="username"></span> (<span id="userRole"></span>)
        </span>
        <button class="btn btn-outline-light btn-sm" onclick="logout()">
          <i class="fas fa-sign-out-alt me-1"></i>Logout
        </button>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- User Management -->
    <div class="card mb-4">
      <div class="card-header bg-primary text-white">
        <h5><i class="fas fa-users me-2"></i>User Management</h5>
      </div>
      <div class="card-body">
        <table class="table table-bordered" id="usersTable">
          <thead>
            <tr>
              <th>Username</th>
              <th>Role</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="input-group mt-2">
          <input type="text" id="newUsername" class="form-control" placeholder="New Username">
          <input type="password" id="newPassword" class="form-control" placeholder="Password">
          <select id="newRole" class="form-select">
            <option>Administrator</option>
            <option>IT Manager</option>
            <option>IT Staff</option>
          </select>
          <button class="btn btn-success" onclick="addUser()"><i class="fas fa-plus"></i></button>
        </div>
      </div>
    </div>

    <!-- System Configuration -->
    <div class="card mb-4">
      <div class="card-header bg-info text-white">
        <h5><i class="fas fa-cogs me-2"></i>System Configuration</h5>
      </div>
      <div class="card-body">
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="featureAudit" checked onchange="saveConfig()">
          <label class="form-check-label" for="featureAudit">Enable Audit Logs</label>
        </div>
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="featureChecklist" checked onchange="saveConfig()">
          <label class="form-check-label" for="featureChecklist">Enable Checklist Creation</label>
        </div>
      </div>
    </div>

    <!-- Audit Logs -->
    <div class="card">
      <div class="card-header bg-warning text-dark">
        <h5><i class="fas fa-clipboard-list me-2"></i>Audit Logs</h5>
      </div>
      <div class="card-body">
  <table class="table table-bordered table-striped" id="auditLogsTable">
    <thead class="table-light">
      <tr>
        <th>Timestamp</th>
        <th>User</th>
        <th>Role</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="auditLogsBody">
      <tr><td colspan="4" class="text-muted text-center">No logs recorded yet</td></tr>
    </tbody>
  </table>
</div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
  <script>
    let currentUser = null;
    let users = JSON.parse(localStorage.getItem("users")) || {
      "admin": { password: "admin123", role: "Administrator" },
      "manager": { password: "manager123", role: "IT Manager" },
      "staff": { password: "staff123", role: "IT Staff" }
    };
    let config = JSON.parse(localStorage.getItem("systemConfig")) || {
      auditLogs: true,
      checklist: true
    };
    let logs = JSON.parse(localStorage.getItem("auditLogs")) || [];

    window.onload = function() {
      const userData = localStorage.getItem("currentUser");
      if (!userData) { window.location.href = "index.html"; return; }
      currentUser = JSON.parse(userData);
      if (currentUser.role !== "Administrator") { window.location.href = "dashboard.html"; return; }
      document.getElementById("username").textContent = currentUser.username;
      document.getElementById("userRole").textContent = currentUser.role;
      renderUsers();
      renderConfig();
      renderLogs();
    };

    // User management
    function renderUsers() {
      const tbody = document.querySelector("#usersTable tbody");
      tbody.innerHTML = "";
      Object.keys(users).forEach(u => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${u}</td>
          <td>${users[u].role}</td>
          <td>
            <button class="btn btn-sm btn-danger" onclick="deleteUser('${u}')"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    function addUser() {
      const username = document.getElementById("newUsername").value.trim();
      const password = document.getElementById("newPassword").value.trim();
      const role = document.getElementById("newRole").value;
      if (!username || !password) return alert("Username and password required");
      if (users[username]) return alert("User already exists");
      users[username] = { password, role };
      localStorage.setItem("users", JSON.stringify(users));
      renderUsers();
      document.getElementById("newUsername").value = "";
      document.getElementById("newPassword").value = "";
      logAction(`Created user ${username} with role ${role}`);
    }

    function deleteUser(username) {
      if (!confirm(`Delete user ${username}?`)) return;
      delete users[username];
      localStorage.setItem("users", JSON.stringify(users));
      renderUsers();
      logAction(`Deleted user ${username}`);
    }

    // Config
    function renderConfig() {
      document.getElementById("featureAudit").checked = config.auditLogs;
      document.getElementById("featureChecklist").checked = config.checklist;
    }
    function saveConfig() {
      config.auditLogs = document.getElementById("featureAudit").checked;
      config.checklist = document.getElementById("featureChecklist").checked;
      localStorage.setItem("systemConfig", JSON.stringify(config));
      logAction("Updated system configuration");
    }

    // Audit Logs
    function logAction(message) {
      if (!config.auditLogs) return;
      const entry = {
        user: currentUser.username,
        role: currentUser.role,
        message,
        time: new Date().toLocaleString()
      };
      logs.push(entry);
      localStorage.setItem("auditLogs", JSON.stringify(logs));
      renderLogs();
    }

    function renderLogs() {
  const tbody = document.getElementById("auditLogsBody");
  tbody.innerHTML = "";

  if (logs.length === 0) {
    tbody.innerHTML = `<tr><td colspan="4" class="text-muted text-center">No logs recorded yet</td></tr>`;
    return;
  }

  logs.slice().reverse().forEach(log => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${log.time}</td>
      <td>${log.user}</td>
      <td>${log.role}</td>
      <td>${log.message}</td>
    `;
    tbody.appendChild(row);
  });
}


    function logout() {
      localStorage.removeItem("currentUser");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
